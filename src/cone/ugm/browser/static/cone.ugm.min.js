var cone_ugm=function(e,t,i,a){"use strict";class s{constructor(){this.delete_item=this.delete_item.bind(this),this.add_item=this.add_item.bind(this),this.remove_item=this.remove_item.bind(this)}delete_item(e){e.preventDefault(),e.stopPropagation();let a=t(e.currentTarget),s=t(".cols .sort_col_1",a.parent().parent()).text();s=s.replace("<","&lt;"),s=s.replace(">","&gt;");let r={action_id:"delete_item"},o=a.attr("ajax:target");t.extend(r,i.ajax.parse_target(o)),t.extend(r,{success:function(e){if(!e)return void i.show_error("Empty response");if(!e.success)return void i.show_error(e.message);let s=a.parent().parent();if(s.hasClass("selected")){t("div.right_column").empty()}s.remove()}});let n=`Do you really want to delete this item?\n\n\n"${s}"`;i.show_dialog({title:"Delete Principal",message:n,on_confirm:function(e){this.perform(r)}.bind(this)})}add_item(e){e.preventDefault(),e.stopPropagation();let a=t(e.currentTarget),s=a.attr("ajax:target"),r=i.ajax.parse_target(s),o=this;t.extend(r,{action_id:"add_item",success:function(e){e?e.success?(a.off().removeClass("add_item").addClass("add_item_disabled").on("click",(function(e){e.preventDefault()})),t(".remove_item_disabled",a.parent()).off().removeClass("remove_item_disabled").addClass("remove_item").on("click",o.remove_item_handle)):i.show_error(e.message):i.show_error("Empty response")}}),this.perform(r)}remove_item(e){e.preventDefault(),e.stopPropagation();let a=t(e.currentTarget),s=a.attr("ajax:target"),r=i.ajax.parse_target(s),o=this;t.extend(r,{action_id:"remove_item",success:function(e){e?e.success?(a.off().removeClass("remove_item").addClass("remove_item_disabled").on("click",(function(e){e.preventDefault()})),t(".add_item_disabled",a.parent()).off().removeClass("add_item_disabled").addClass("add_item").on("click",o.add_item_handle)):i.show_error(e.message):i.show_error("Empty response")}}),this.perform(r)}perform(e){i.ajax.request({url:`${i.parse_url(e.url)}/${e.action_id}`,type:"json",params:e.params,success:e.success})}}class r{static initialize(e){a.BatchedItemsSearch.initialize(e,"div.column_filter input","filter"),new o(e),new n(e)}constructor(){this.actions=new s}noop(e){e.preventDefault()}set_selected(e){this.reset_selected(e.parent()),e.addClass("selected")}reset_selected(e){t("li",e).removeClass("selected")}}class o extends r{constructor(e){super(),t("div.add_button button",e).off("click").on("click",this.add_principal.bind(this));let i=t("div.columnitems div.actions",e);t("a.delete_item",i).off().on("click",this.actions.delete_item),t("a.delete_item_disabled",i).off().on("click",this.noop),t("ul.leftlisting li",e).off().on("click",this.show_item.bind(this))}add_principal(e){e.preventDefault(),e.stopPropagation();let a=t(".left_column ul.leftlisting");this.reset_selected(a);let s=t(e.currentTarget),r=i.ajax.parse_target(s.attr("ajax:target"));i.ajax.action({name:"add",selector:".right_column",mode:"inner",url:r.url,params:r.params})}show_item(e){let a=t(e.currentTarget);this.set_selected(a);let s=i.ajax.parse_target(a.attr("ajax:target"));return i.ajax.action({name:"rightcolumn",selector:".right_column",mode:"replace",url:s.url,params:s.params}),!1}}class n extends r{constructor(e){super();let i=t("div.columnitems div.actions",e);t("a.add_item",i).off().on("click",this.actions.add_item),t("a.add_item_disabled",i).off().on("click",this.noop),t("a.remove_item",i).off().on("click",this.actions.remove_item),t("a.remove_item_disabled",i).off().on("click",this.noop),t("ul.rightlisting li",e).off().on("click",this.show_item.bind(this)),t("div.column_limit input.list_all",e).off().on("click",this.list_related.bind(this))}show_item(e){let a=t(e.currentTarget);this.set_selected(a);let s=a.attr("ajax:target");return i.ajax.trigger("contextchanged",".contextsensitiv",s),i.ajax.trigger("contextchanged","#content",s),!1}list_related(e){let a,s=t(e.currentTarget);a=s.prop("checked")?"allcolumnlisting":"columnlisting";let r=i.ajax.parse_target(s.attr("ajax:target"));i.ajax.action({name:a,selector:"div.right_column .columnlisting",mode:"replace",url:r.url,params:r.params})}}return t((function(){i.ajax.register(r.initialize,!0)})),e.LeftPrincipalListing=o,e.PrincipalActions=s,e.PrincipalListing=r,e.RightPrincipalListing=n,e.lm_autocomplete_gid=function(e,t){i.ajax.request({success:function(e){t(e)},url:"group_id_vocab",params:{term:e.term},type:"json"})},Object.defineProperty(e,"__esModule",{value:!0}),window.ugm=e,e}({},jQuery,treibstoff,cone);
//# sourceMappingURL=cone.ugm.min.js.map
